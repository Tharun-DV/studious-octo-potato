---
// Image Popup Component for Blog Images
---

<div id="image-popup" class="image-popup hidden">
  <div class="image-popup-backdrop"></div>
  <div class="image-popup-content">
    <button class="image-popup-close" aria-label="Close popup">&times;</button>
    <img id="popup-image" src="" alt="" class="popup-image">
    <div class="image-popup-caption"></div>
  </div>
</div>

<script>
  document.addEventListener('DOMContentLoaded', function() {
    const popup = document.getElementById('image-popup');
    const popupImage = document.getElementById('popup-image');
    const popupCaption = document.querySelector('.image-popup-caption');
    const closeButton = document.querySelector('.image-popup-close');
    const backdrop = document.querySelector('.image-popup-backdrop');

    function openPopup(src, alt) {
      popupImage.src = src;
      popupImage.alt = alt;
      popupCaption.textContent = alt || '';
      popup.classList.remove('hidden');
      document.body.style.overflow = 'hidden';
    }

    function closePopup() {
      popup.classList.add('hidden');
      document.body.style.overflow = '';
      popupImage.src = '';
      popupCaption.textContent = '';
    }

    // Add click handlers to all images in blog content
    function initializeImages() {
      const blogContent = document.querySelector('.blog-content');
      if (!blogContent) return;

      const images = blogContent.querySelectorAll('img');
      images.forEach(img => {
        img.style.cursor = 'pointer';
        img.addEventListener('click', () => {
          openPopup(img.src, img.alt);
        });
      });
    }

    // Close popup handlers
    closeButton.addEventListener('click', closePopup);
    backdrop.addEventListener('click', closePopup);
    
    // Close on Escape key
    document.addEventListener('keydown', (e) => {
      if (e.key === 'Escape' && !popup.classList.contains('hidden')) {
        closePopup();
      }
    });

    // Initialize images when DOM is ready
    initializeImages();
  });
</script>

<style>
  .image-popup {
    position: fixed;
    top: 0;
    left: 0;
    width: 100vw;
    height: 100vh;
    z-index: 9999;
    display: flex;
    align-items: center;
    justify-content: center;
    padding: 2rem;
    box-sizing: border-box;
  }

  .image-popup.hidden {
    display: none;
  }

  .image-popup-backdrop {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background-color: rgba(0, 0, 0, 0.9);
    backdrop-filter: blur(5px);
  }

  .image-popup-content {
    position: relative;
    max-width: 90vw;
    max-height: 90vh;
    display: flex;
    flex-direction: column;
    align-items: center;
    z-index: 1;
  }

  .image-popup-close {
    position: absolute;
    top: -40px;
    right: 0;
    background: none;
    border: none;
    color: white;
    font-size: 2rem;
    cursor: pointer;
    padding: 0.5rem;
    line-height: 1;
    z-index: 2;
    transition: opacity 0.2s ease;
  }

  .image-popup-close:hover {
    opacity: 0.7;
  }

  .popup-image {
    max-width: 100%;
    max-height: 100%;
    object-fit: contain;
    border-radius: 8px;
    box-shadow: 0 20px 40px rgba(0, 0, 0, 0.3);
  }

  .image-popup-caption {
    margin-top: 1rem;
    color: white;
    text-align: center;
    font-size: 0.9rem;
    font-family: 'Fira Code', monospace;
    max-width: 60ch;
    line-height: 1.4;
  }

  @media (max-width: 768px) {
    .image-popup {
      padding: 1rem;
    }
    
    .image-popup-close {
      top: -35px;
      font-size: 1.5rem;
    }
    
    .image-popup-caption {
      font-size: 0.8rem;
      max-width: 90%;
    }
  }
</style>